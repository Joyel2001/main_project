{% load static %}

<!-- Add a back button to navigate to the previous page -->
<a href="{% url 'bin_details' user_id=booking.user.id %}" class="btn btn-secondary back-button">
    <i class="fas fa-arrow-left"></i> Back
</a>
<div class="container edit-booking-container">
    <h2>Edit Booking Details</h2>
    <form method="post" action="{% url 'edit_booking_details' booking.booking_id %}" class="edit-booking-form" onsubmit="return validateBookingForm()">
        {% csrf_token %}
        
        <!-- Apply some styling to labels and input fields -->
        <div class="form-group">
            <label for="collection_day">Collection Day:</label>
            <select id="collection_day" name="collection_day" class="form-control" onchange="validateCollectionDay()">
                <option value="">Select a Collection Day</option>
                <option value="Saturday" {% if booking.collection_period == 'Saturday' %}selected{% endif %}>Saturday</option>
                <option value="Wednesday" {% if booking.collection_period == 'Wednesday' %}selected{% endif %}>Wednesday</option>
            </select>
            <p id="collectionDayError" class="text-danger"></p>
        </div>
        
        <div class="form-group">
            <label for="house_number">House Number:</label>
            <input type="text" id="house_number" name="house_number" class="form-control" value="{{ booking.house_number }}" onblur="validateHouseNumber()">
            <p id="houseNumberError" class="text-danger"></p>
        </div>
        
        <div class="form-group">
            <label for="landmark">Landmark near:</label>
            <input type="text" id="landmark" name="landmark" class="form-control" value="{{ booking.landmark }}" onblur="validateLandmark()">
            <p id="landmarkError" class="text-danger"></p>
        </div>
        
        <!-- Style the submit button -->
        <button type="submit" class="btn btn-primary">Save Changes</button>
    </form>
</div>
<!-- JavaScript function for form validation -->
<script>
    function validateCollectionDay() {
        var collectionDay = document.getElementById("collection_day").value;
        var collectionDayError = document.getElementById("collectionDayError");
        if (collectionDay === "") {
            collectionDayError.textContent = "Please select a Collection Day.";
        } else {
            collectionDayError.textContent = "";
        }
    }

    function validateHouseNumber() {
        var houseNumber = document.getElementById("house_number").value;
        var houseNumberError = document.getElementById("houseNumberError");
        if (houseNumber === "") {
            houseNumberError.textContent = "Please enter a House Number.";
        } else {
            houseNumberError.textContent = "";
        }
    }

    function validateLandmark() {
        var landmark = document.getElementById("landmark").value;
        var landmarkError = document.getElementById("landmarkError");
        if (landmark === "") {
            landmarkError.textContent = "Please enter a Landmark.";
        } else {
            landmarkError.textContent = "";
        }
    }

    function validateBookingForm() {
        validateCollectionDay();
        validateHouseNumber();
        validateLandmark();
        
        // Check if any validation errors exist
        var collectionDayError = document.getElementById("collectionDayError").textContent;
        var houseNumberError = document.getElementById("houseNumberError").textContent;
        var landmarkError = document.getElementById("landmarkError").textContent;
        
        if (collectionDayError || houseNumberError || landmarkError) {
            return false; // Prevent form submission if there are errors
        }
        
        return true; // Allow form submission if all validations pass
    }
</script>
<!-- Apply some custom styles using CSS -->
<style>
    /* Style for the edit booking container */
    .edit-booking-container {
        background-color: #fff;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        max-width: 400px;
        margin: 20px auto;
        text-align: center;
    }

    /* Style for form labels */
    .edit-booking-form label {
        font-weight: bold;
    }

    /* Style for form input fields */
    .edit-booking-form .form-control {
        width: 100%;
        padding: 10px;
        margin-top: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        font-size: 16px;
    }

    /* Style for the submit button */
    .edit-booking-form button {
        display: block;
        margin-top: 20px;
        background-color: #007BFF;
        color: #fff;
        border: none;
        padding: 10px 20px;
        font-size: 18px;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .edit-booking-form button:hover {
        background-color: #0056b3;
    }

    /* Style for the back button */
    .back-button {
        display: inline-block;
        margin-bottom: 10px;
        padding: 10px 20px;
        font-size: 16px;
        border-radius: 5px;
        text-decoration: none;
        background-color: #007BFF;
        color: #fff;
        transition: background-color 0.3s;
    }

    .back-button i {
        margin-right: 5px;
    }

    .back-button:hover {
        background-color: #0056b3;
    }
</style>


<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bin Booking</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f5f5f5;
        margin: 0;
        padding: 0;
    }

    .container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: #ffffff;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    h1 {
        text-align: center;
        margin-bottom: 20px;
    }

    label {
        display: block;
        font-weight: bold;
        margin-bottom: 5px;
    }

    input[type="text"],
    input[type="email"],
    select {
        width: 100%;
        padding: 10px;
        margin-bottom: 15px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }

    .btn {
        display: inline-block;
        padding: 10px 20px;
        background-color: #3498db;
        color: #ffffff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    .btn:hover {
        background-color: #2980b9;
    }
</style>
<!DOCTYPE html>
<html>
<head>
    <!-- Include your CSS and other header content here -->
</head>
<div class="container">
    <h1>Book a Bin</h1>
    <form id="bookingForm" method="post" onsubmit="return validateForm()">
        {% csrf_token %}

        <label for="houseNumber">House Number:</label>
        <input type="text" id="houseNumber" name="houseNumber" >
        <div id="houseNumber-error" class="error-message"></div>

        <label for="landmark">Nearby Landmark:</label>
        <input type="text" id="landmark" name="landmark" >
        <div id="landmark-error" class="error-message"></div><br>

        <label for="collectionPeriod">Waste Collection Day:</label>
        <select id="collectionPeriod" name="collectionPeriod" >
            <option value="" disabled selected>Select Collection Day</option>
            <option value="Wednesday">Wednesday</option>
            <option value="Saturday">Saturday</option>
        </select>
        <div id="collectionPeriod-error" class="error-message"></div><br>

        <label for="pin">Pin Code:</label>
        <input type="text" id="pin" name="pin" >
        <div id="pin-error" class="error-message"></div>

        <div class="down-content">
            <label for="binDetails">Select Bin Size and Capacity:</label>
            <select id="binDetails" name="binDetails" >
                <option value="" disabled selected>Select Bin Size and Capacity</option>
                {% for bin in bins %}
                    <option value="{{ bin.size }} - {{ bin.capacity }}">
                        {{ bin.size }} ({{ bin.capacity }})
                    </option>
                {% endfor %}
            </select>
            <div id="binDetails-error" class="error-message"></div>

            <div class="main-buttons">
                <a href="{% url 'bin_order' %}" class="btn btn-secondary back-button">
                    <i class="fas fa-arrow-left"></i> Back
                </a>
                <button type="submit" id="purchaseBtn" class="btn btn-primary purchase-button">Purchase Bin</button>
            </div>
            
        </div>
        {% if messages %}
        <ul class="messages">
            {% for message in messages %}
                <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
            {% endfor %}
        </ul>
        {% endif %}
    </form>
</div>

<script>
    // Function to show an error message for a field
    function showError(fieldId, errorMessage) {
        var errorElement = document.getElementById(fieldId + "-error");
        errorElement.textContent = errorMessage;
    }

    // Function to clear an error message for a field
    function clearError(fieldId) {
        var errorElement = document.getElementById(fieldId + "-error");
        errorElement.textContent = "";
    }

    // Function to validate the House Number field
    function validateHouseNumber() {
        var houseNumber = document.getElementById("houseNumber").value.trim();
        if (houseNumber === "") {
            showError("houseNumber", "Please enter a House Number.");
            return false;
        } else {
            clearError("houseNumber");
            return true;
        }
    }

    // Function to validate the Landmark field
    function validateLandmark() {
        var landmark = document.getElementById("landmark").value.trim();
        if (landmark === "") {
            showError("landmark", "Please enter a Landmark.");
            return false;
        } else {
            clearError("landmark");
            return true;
        }
    }

    // Function to validate the Waste Collection Day field
    function validateCollectionDay() {
        var collectionPeriod = document.getElementById("collectionPeriod").value.trim();
        if (collectionPeriod === "") {
            showError("collectionPeriod", "Please select a Collection Day.");
            return false;
        } else {
            clearError("collectionPeriod");
            return true;
        }
    }

    // Function to validate the Pin Code field
    function validatePinCode() {
        var pin = document.getElementById("pin").value.trim();
        if (!/^\d{6}$/.test(pin)) {
            showError("pin", "Pin Code should be 6 numbers.");
            return false;
        } else {
            clearError("pin");
            return true;
        }
    }

    // Function to validate the Bin Details field
    function validateBinDetails() {
        var binDetails = document.getElementById("binDetails").value.trim();
        if (binDetails === "") {
            showError("binDetails", "Please select Bin Size and Capacity.");
            return false;
        } else {
            clearError("binDetails");
            return true;
        }
    }

    // Add event listeners to validate fields as they lose focus
    document.getElementById("houseNumber").addEventListener("blur", validateHouseNumber);
    document.getElementById("landmark").addEventListener("blur", validateLandmark);
    document.getElementById("collectionPeriod").addEventListener("blur", validateCollectionDay);
    document.getElementById("pin").addEventListener("blur", validatePinCode);
    document.getElementById("binDetails").addEventListener("blur", validateBinDetails);

    // Function to validate the form when submitted
    function validateForm() {
        // Validate House Number
        if (!validateHouseNumber()) {
            return false;
        }

        // Validate Landmark
        if (!validateLandmark()) {
            return false;
        }

        // Validate Waste Collection Day
        if (!validateCollectionDay()) {
            return false;
        }

        // Validate Pin Code
        if (!validatePinCode()) {
            return false;
        }

        // Validate Bin Details
        if (!validateBinDetails()) {
            return false;
        }

        // If all validations pass, allow form submission
        return true;
    }
</script>
